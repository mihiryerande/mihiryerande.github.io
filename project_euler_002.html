<!DOCTYPE HTML>
<!--
	Helios by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Mihir Yerande</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<link rel="apple-touch-icon" sizes="180x180" href="assets/favicon/apple-touch-icon.png">
		<link rel="icon" type="image/png" sizes="32x32" href="assets/favicon/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="assets/favicon/favicon-16x16.png">
		<link rel="manifest" href="assets/favicon/site.webmanifest">
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
		<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
		<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
	</head>
	<body class="no-sidebar is-preload">
		<div id="page-wrapper">

			<!-- Header -->
				<div id="header">

					<!-- Inner -->
						<div class="inner">
							<header>
								<h1><a href="index.html" id="logo">Mihir Yerande</a></h1>
							</header>
						</div>

					<!-- Nav -->
						<nav id="nav">
							<ul>
								<li><a href="index.html">Home</a></li>
								<!-- <li>
									<a href="#">Dropdown</a>
									<ul>
										<li><a href="projects_main.html">Projects</a></li>
										<li><a href="#">Lorem ipsum dolor</a></li>
										<li><a href="#">Magna phasellus</a></li>
										<li><a href="#">Etiam dolore nisl</a></li>
										<li>
											<a href="#">And a submenu &hellip;</a>
											<ul>
												<li><a href="#">Lorem ipsum dolor</a></li>
												<li><a href="#">Phasellus consequat</a></li>
												<li><a href="#">Magna phasellus</a></li>
												<li><a href="#">Etiam dolore nisl</a></li>
											</ul>
										</li>
										<li><a href="#">Veroeros feugiat</a></li>
									</ul>
								</li>
								<li><a href="left-sidebar.html">Left Sidebar</a></li>
								<li><a href="right-sidebar.html">Right Sidebar</a></li>
								<li><a href="no-sidebar.html">No Sidebar</a></li> -->
								<li><a href="projects_main.html">Projects</a></li>
								<li><a href="project_euler_main.html">Project Euler</a></li>
								<li><a href="notes_main.html">Notes</a></li>
								<li><a href="resume_mihiryerande.pdf" target="_blank">Résumé</a></li>
							</ul>
						</nav>

				</div>

			<!-- Main -->
				<div class="wrapper style1">

					<div class="container">
						<article id="main" class="special">
							<header>
								<h2><a href="project_euler_main.html">Project Euler</a></h2><br/>
								<h2>Problem #2 - <i>Even Fibonacci Numbers</i></h2>
							</header>
							<section>
								<header>
									<h3>Original Problem Statement</h3>
								</header>
								<p>
									Each new term in the Fibonacci sequence is generated by adding the previous two terms.<br/>
									By starting with 1 and 2, the first 10 terms will be:<br/>
									&emsp;1, 2, 3, 5, 8, 13, 21, 34, 55, 89, ...<br/><br/>
									By considering the terms in the Fibonacci sequence whose values do not exceed four million, find the sum of the even-valued terms.
								</p>
							</section>
							<hr/>
							<section>
								<header>
									<h3>Initial Thoughts</h3>
								</header>
								<p>
									The Fibonacci numbers are interesting for many reasons, and much discussion can be had about them.<br/>
									I've discussed them a bit here: <a href="notes_fibonacci.html">Fibonacci Numbers</a><br/>
									However, for the sake of solving this problem, we will avoid that discussion and skip ahead to find a practical solution.<br/><br/>
									Note that we define the <i>Fibs</i> as follows:
									<ul>
										<li>\(F_0 = 0\)</li>
										<li>\(F_1 = 1\)</li>
										<li>\(F_n = F_{n-1} + F_{n-2}\), where \(n \in \mathbb{N}\) and \(n \geq 2\)</li>
									</ul>
									This differs from the sequence given in the problem statement, but it will be notationally convenient to use this enumeration.<br/><br/>
									Additionally, note the following constants which will be used below:
									<ul>
										<li>Lowercase phi: \(\hspace{1em}\displaystyle\phi = \frac{1+\sqrt{5}}{2} \approx 1.618\cdots\)</li>
										<li>Lowercase psi: \(\hspace{1em}\displaystyle\psi = \frac{1-\sqrt{5}}{2} \approx -0.618\cdots\)</li>
									</ul><br/>
									With the Fibs enumerated as above, along with these constants, the closed-form expression turns out to be:<br/><br/>
									\(\hspace{1em}\displaystyle F_n = \frac{\phi^n - \psi^n}{\sqrt{5}}\)<br/><br/>
									Also, it turns out that the subtracted term, \(\displaystyle\frac{\psi^n}{\sqrt{5}}\), always has a magnitude below \(0.5\).<br/>
									This is great for the sake of calculation, as it allows us to simplify the formula:<br/><br/>
									\(\hspace{1em}\displaystyle F_n = round\left(\frac{\phi^n}{\sqrt{5}}\right)\)<br/><br/>
									With all of this in mind, let's proceed (╯°□°）╯︵ ┻━┻ !!
								</p>
							</section>
							<hr/>
							<section>
								<header>
									<h3>Iterative Approach (Brute-Force)</h3>
								</header>
								<p>
									At first glance, we could easily write some code to iterate upwards and enumerate the Fibs in sequence.<br/>
									The following code would accomplish what we need:
									<script src="https://gist.github.com/mihiryerande/ec0e2566ff8da5549d9ab34ba525c044.js"></script><br/>
									The computational complexity, namely the time-complexity here, depends on the number of iterations needed to enumerate until \(M\)<br/>
									Recall that the sequence turns out to be roughly exponential, where \(F_n \sim \phi^n\).<br/>
									Thus the number of iterations as well as the time-complexity are of magnitude \(O(log(M))\)<br/><br/>
									<b>Can we do better? → YES</b>
								</p>
							</section>
							<hr/>
							<section>
								<header>
									<h3>Iterative Approach (Improved)</h3>
								</header>
								<p>
									Let's look closer at the Fibs sequence.<br/>
									&emsp;<b>0</b>, 1, 1, <b>2</b>, 3, 5, <b>8</b>, 13, 21, <b>34</b>, 55, 89, ...<br/>
									Recall that we're only concerned with the <i>even</i> entries of the sequence.<br/>
									It seems that only every <i>third</i> entry in the sequence is even.<br/>
									Why?<br/><br/>
									Consider only the <i>parity</i> (even-ness or odd-ness) of the sequence, as follows:<br/><br/>
									\(
										\begin{align*}
											\hspace{1em}F_0 &= 0                     &                     & \rightarrow\text{ even} \\
											\hspace{1em}F_1 &= 1                     &                     & \rightarrow\text{ odd} \\
											\hspace{1em}F_2 &= F_0 + F_1 \rightarrow & \text{ even + odd } & \rightarrow\text{ odd} \\
											\hspace{1em}F_3 &= F_1 + F_2 \rightarrow & \text{ odd + odd }  & \rightarrow\text{ even} \\
											\hspace{1em}F_4 &= F_2 + F_3 \rightarrow & \text{ odd + even } & \rightarrow\text{ odd} \\
											\hspace{1em}F_5 &= F_3 + F_4 \rightarrow & \text{ even + odd } & \rightarrow\text{ odd} \\
										\end{align*}
									\)<br/><br/>
									It turns out that the parity of the sequence has a cyclical nature, which explains why every third element, \(F_{3j}\), is even!<br/>
									We can use this to our advantage to avoid the parity check by simply skipping to every 3<sup>rd</sup> Fib, and adding.<br/><br/>
									The previous code can be modified to the following:
									<script src="https://gist.github.com/mihiryerande/826d92e56daa3cb9607761f9c39ad7b7.js"></script><br/>
									Although we've modified the code to avoid divisibility checks, it is still iterating similarly as before.<br/>
									The time-complexity thus remains at \(O(log(M))\).<br/><br/>
									<b>Can we do better !? → YES</b>
								</p>
							</section>
							<hr/>
							<section>
								<header>
									<h3>Iterative Approach (Double-Improved)</h3>
								</header>
							</section>
									The previous code can be modified even further to avoid the triple-step iteration.<br/>
									Assuming we know elements \(F_i\) and \(F_{i+1}\), we'd like step forwards thrice to calculate elements \(F_{i+3}\) and \(F_{i+4}\).<br/>
									We can calculate these in terms of the known elements as follows:<br/><br/>
									\(
										\begin{align*}
											\hspace{1em}F_{i+3} &= F_{i+2} + F_{i+1} \\
											\hspace{1em}        &= (F_{i+1} + F_i) + F_{i+1} \\
											\hspace{1em}        &= 2\cdot F_{i+1} + F_i
										\end{align*}
									\)<br/><br/>
									Using the previous expression for \(F_{i+3}\) to determine \(F_{i+4}\) ...:<br/><br/>
									\(
										\begin{align*}
											\hspace{1em}F_{i+4} &= F_{i+3} + F_{i+2} \\
											\hspace{1em}        &= (2\cdot F_{i+1} + F_i) + (F_{i+1} + F_i) \\
											\hspace{1em}        &= 3\cdot F_{i+1} + 2\cdot F_i
										\end{align*}
									\)<br/><br/>
									Now we can avoid the triple-step iteration by directly updating as follows:
									<script src="https://gist.github.com/mihiryerande/4ea058bb15126212d33fd38867c8cd09.js"></script><br/>
									We've improved the absolute runtime by cutting out some intermediate arithmetic operations.<br/>
									However, the overall time-complexity hasn't been improved, as we're iterating in pretty much the same way.<br/><br/>
									<b>Can we do better !?!? → YES</b>
								</p>
							</section>
							<hr/>
							<section>
								<header>
									<h3>Summation Approach</h3>
								</header>
								<p>
									Let's look directly at the desired answer, formulated as a summation:<br/><br/>
									\(
										\begin{align*}
											\hspace{1em}S &= \displaystyle\sum_{i \in \mathbb{N}_0} F_i \cdot \mathbb{1}_{\{F_i\text{ is even } \wedge\hspace{0.2em}F_i \leq M\}}   & \text{Desired answer} \\
											\hspace{1em}  &= \displaystyle\sum_{i \in \mathbb{N}_0} F_i \cdot \mathbb{1}_{\{F_i\text{ is even}\}} \cdot \mathbb{1}_{\{F_i \leq M\}} & \text{Split indicator into separate predicates} \\
											\hspace{1em}  &= \displaystyle\sum_{i \in \mathbb{N}} F_i \cdot \mathbb{1}_{\{F_i\text{ is even}\}} \cdot \mathbb{1}_{\{F_i \leq M\}}   & F_0 = 0
										\end{align*}
									\)<br/><br/>
									where \(\mathbb{1}_{\cdots}\) is an indicator variable taking values 0 or 1, depending on the specified predicate.
								</p>
								<h4>Element-wise Parity</h4>
								<p>
									We discovered previously that only every <i>third</i> Fib is even, so we can improve our summation:<br/><br/>
									\(
										\hspace{1em}S = \displaystyle\sum_{j \in \mathbb{N}} F_{3j} \cdot \mathbb{1}_{\{F_{3j} \leq M\}}
									\)
								</p>
								<h4>Upper Bound</h4>
								<p>
									Now we need to determine the upper bound, \(j_{max}\), of the iterator variable, \(j\).<br/>
									This would be the maximum such \(j\) for which \(F_{3j} \leq M\).<br/>
									We can determine it as follows:<br/><br/>
									\(
										\begin{align*}
											F_{3j}                                       & \leq M                       & \text{Desired condition} \\
											\frac{\phi^{3j} - \psi^{3j}}{\sqrt{5}}       & \leq M                       & \text{Substitute with closed-form expression} \\
											round\left(\frac{\phi^{3j}}{\sqrt{5}}\right) & \leq M                       & \text{Simplified formula version} \\
											\frac{\phi^{3j}}{\sqrt{5}}                   & \lt M + 0.5                  & \text{Accounting for rounding} \\
											\phi^{3j}                                    & \lt (M + 0.5) \cdot \sqrt{5} \\
											ln(\phi^{3j})                                & \lt ln((M + 0.5) \cdot \sqrt{5}) \\
											3j \cdot ln(\phi)                            & \lt ln(M + 0.5) + \frac{1}{2}ln(5) \\
											j                                            & \lt \frac{ln(M + 0.5) + \frac{1}{2}ln(5)}{3 \cdot ln(\phi)} \\
											j_{max}                                      & = ceil\left(\frac{ln(M + 0.5) + \frac{1}{2}ln(5)}{3 \cdot ln(\phi)}\right) - 1 & \text{Maximum possible value of }j
										\end{align*}
									\)<br/><br/>
									Given this upper bound, we can simplify our prior summation to the following:<br/><br/>
									\(
										\hspace{1em}S = \displaystyle\sum_{j=1}^{j_{max}} F_{3j}
									\)
								</p>
								<h4>Geometric Series</h4>
								<p>
									Additionally, as stated before, the Fibs turn out to be <i>roughly</i> equal to a <a href="https://en.wikipedia.org/wiki/Geometric_progression">geometric progression</a>.<br/>
									Perhaps, then, we can convert the summation to a <a href=""https://en.wikipedia.org/wiki/Geometric_series#Finite_series">closed-form expression</a>!<br/><br/>
									Note that rounding many values and then summing is not necessarily the same as summing and the rounding.<br/>
									For example, \(round(0.5) + round(0.5) = 1 + 1 = 2\), whereas \(round(0.5 + 0.5) = round(1) = 1\).<br/>
									Hence we start with the unrounded expression:<br/><br/>
									\(
										\begin{align*}
											\hspace{1em}S &= \displaystyle\sum_{j=1}^{j_{max}} F_{3j} & \text{Desired summation} \\
											\hspace{1em}  &= \displaystyle\sum_{j=1}^{j_{max}} \frac{\phi^{3j} - \psi^{3j}}{\sqrt{5}} & \text{Exact formula} \\
											\hspace{1em}  &= \displaystyle\sum_{j=1}^{j_{max}} \frac{\phi^{3j}}{\sqrt{5}} - \sum_{j=1}^{j_{max}} \frac{\psi^{3j}}{\sqrt{5}} & \text{Separate into two summations} \\
											\hspace{1em}  &= \displaystyle\frac{1}{\sqrt{5}}\sum_{j=1}^{j_{max}} \phi^{3j} - \frac{1}{\sqrt{5}}\sum_{j=1}^{j_{max}} \psi^{3j} & \text{Factor out constant} \\
											\hspace{1em}  &= \displaystyle\frac{1}{\sqrt{5}} \cdot \frac{\phi^3 \cdot (1-(\phi^3)^{j_{max}})}{1-\phi^3} - \frac{1}{\sqrt{5}} \cdot \frac{\psi^3 \cdot (1-(\psi^3)^{j_{max}})}{1-\psi^3} & \text{Closed-form for finite geometric series} \\
											\hspace{1em}  &= round\left(\displaystyle\frac{1}{\sqrt{5}} \cdot \frac{\phi^3 \cdot (1-(\phi^3)^{j_{max}})}{1-\phi^3}\right) & \text{Subtracted term is negligible} \\
										\end{align*}
									\)<br/><br/>
								</p>
								<h4>Final Code</h4>
								<p>
									We've found a direct formula to calculate the sum!<br/>
									The code is now as follows:<br/>
									<script src="https://gist.github.com/mihiryerande/e35d62f372bc4624fb81698f3f6726a6.js"></script><br/><br/>
									The time-complexity has been reduced to \(O(1)\) as we only need to compute a fixed number of arithmetic operations.
								</p>
							</section>
							<hr/>
							<section>
								<header>
									<h3>Answer</h3>
								</header>
								<p>
									The answer can be easily computed manually with a calculator, giving the following:<br/><br/>
									\(
										\begin{align*}
											\hspace{1em}M &= 4,000,000 \\\\

											\hspace{1em}j_{max} &= ceil\left(\frac{ln(M + 0.5) + \frac{1}{2}ln(5)}{3 \cdot ln(\phi)}\right) - 1 \\
											\hspace{1em}        &= ceil\left(11.088\cdots\right) - 1 \\
											\hspace{1em}        &= 11 \\\\
											
											\hspace{1em}S &= round\left(\displaystyle\frac{1}{\sqrt{5}} \cdot \frac{\phi^3 \cdot (1-(\phi^3)^{j_{max}})}{1-\phi^3}\right) \\
											\hspace{1em}  &= round\left(\displaystyle\frac{1}{\sqrt{5}} \cdot \frac{\phi^3 \cdot (1-(\phi^3)^{11})}{1-\phi^3}\right) \\
											\hspace{1em}  &= round\left(4,613,731.9\cdots\right) \\
											\hspace{1em}  &= 4,613,732
										\end{align*}
									\)
								</p>
							</section>
							<hr/>
							<section>
								<header>
									<h3>My Solution on GitHub</h3>
								</header>
								<p>
									The full Python3 code for my solution implementation can be found here:
									<a href="https://github.com/mihiryerande/project-euler-002">GitHub Solution</a>
								</p>
							</section>
						</article>
					</div>
				</div>

			<!-- Footer -->
				<div id="footer">
					<div class="container">
						<div class="row">

							<!-- Tweets -->
								<section class="col-4 col-12-mobile">
									<header>
										<h2 class="icon brands fa-twitter circled"><span class="label">Tweets</span></h2>
									</header>
									<ul class="divided">
										<li>
											<article class="tweet">
												Amet nullam fringilla nibh nulla convallis tique ante sociis accumsan.
												<span class="timestamp">5 minutes ago</span>
											</article>
										</li>
										<li>
											<article class="tweet">
												Hendrerit rutrum quisque.
												<span class="timestamp">30 minutes ago</span>
											</article>
										</li>
										<li>
											<article class="tweet">
												Curabitur donec nulla massa laoreet nibh. Lorem praesent montes.
												<span class="timestamp">3 hours ago</span>
											</article>
										</li>
										<li>
											<article class="tweet">
												Lacus natoque cras rhoncus curae dignissim ultricies. Convallis orci aliquet.
												<span class="timestamp">5 hours ago</span>
											</article>
										</li>
									</ul>
								</section>

							<!-- Posts -->
								<section class="col-4 col-12-mobile">
									<header>
										<h2 class="icon solid fa-file circled"><span class="label">Posts</span></h2>
									</header>
									<ul class="divided">
										<li>
											<article class="post stub">
												<header>
													<h3><a href="#">Nisl fermentum integer</a></h3>
												</header>
												<span class="timestamp">3 hours ago</span>
											</article>
										</li>
										<li>
											<article class="post stub">
												<header>
													<h3><a href="#">Phasellus portitor lorem</a></h3>
												</header>
												<span class="timestamp">6 hours ago</span>
											</article>
										</li>
										<li>
											<article class="post stub">
												<header>
													<h3><a href="#">Magna tempus consequat</a></h3>
												</header>
												<span class="timestamp">Yesterday</span>
											</article>
										</li>
										<li>
											<article class="post stub">
												<header>
													<h3><a href="#">Feugiat lorem ipsum</a></h3>
												</header>
												<span class="timestamp">2 days ago</span>
											</article>
										</li>
									</ul>
								</section>

							<!-- Photos -->
								<section class="col-4 col-12-mobile">
									<header>
										<h2 class="icon solid fa-camera circled"><span class="label">Photos</span></h2>
									</header>
									<div class="row gtr-25">
										<div class="col-6">
											<a href="#" class="image fit"><img src="images/pic10.jpg" alt="" /></a>
										</div>
										<div class="col-6">
											<a href="#" class="image fit"><img src="images/pic11.jpg" alt="" /></a>
										</div>
										<div class="col-6">
											<a href="#" class="image fit"><img src="images/pic12.jpg" alt="" /></a>
										</div>
										<div class="col-6">
											<a href="#" class="image fit"><img src="images/pic13.jpg" alt="" /></a>
										</div>
										<div class="col-6">
											<a href="#" class="image fit"><img src="images/pic14.jpg" alt="" /></a>
										</div>
										<div class="col-6">
											<a href="#" class="image fit"><img src="images/pic15.jpg" alt="" /></a>
										</div>
									</div>
								</section>

						</div>
						<hr />
						<div class="row">
							<div class="col-12">

								<!-- Contact -->
									<section class="contact">
										<header>
											<h3>Nisl turpis nascetur interdum?</h3>
										</header>
										<p>Urna nisl non quis interdum mus ornare ridiculus egestas ridiculus lobortis vivamus tempor aliquet.</p>
										<ul class="icons">
											<li><a href="https://www.facebook.com/mihiryerande" target = "_blank" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
											<li><a href="https://www.instagram.com/mihiryerande" target = "_blank" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>
											<li><a href="https://www.instagram.com/suziethemutt" target = "_blank" class="fa fa-paw"><span class="label"></span></a></li>
											<li><a href="https://www.ravelry.com/people/mihiryerande" target = "_blank" class="icon brands fa-ravelry"><span class="label">Ravelry</span></a></li>
											<li><a href="https://www.github.com/mihiryerande" target = "_blank" class="icon brands fa-github"><span class="label">GitHub</span></a></li>
											<li><a href="https://www.linkedin.com/in/mihiryerande/" target = "_blank" class="icon brands fa-linkedin-in"><span class="label">Linkedin</span></a></li>
											<li><a href="resume_mihiryerande.pdf" target = "_blank" class="icon fa-file"><span class="label">Résumé</span></a></li>
											<li><a href="mailto:mihiryerande@gmail.com" target = "_blank" class="icon fa fa-envelope"><span class="label">Email</span></a></li>
										</ul>
									</section>

								<!-- Copyright -->
									<div class="copyright">
										<ul class="menu">
											<li>&copy; Mihir Yerande. All rights reserved.</li>
											<li>Design: <i>Helios</i> from <a href="http://html5up.net">HTML5 UP</a></li>
											<li>Built with HTML5/CSS3</li>
											<li>Released under the <a href="http://html5up.net/license">CCA</a> license.</li>
										</ul>
									</div>

							</div>

						</div>
					</div>
				</div>

		</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.dropotron.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>